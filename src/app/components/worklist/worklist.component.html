<div class="mycontainer">
   

        <!-- <div class="form-check">
          <input class="form-check-input" type="checkbox" (change)="selectAll()" [checked]="selectedAll">
          <label class="form-check-label">
            Select All
          </label>
        </div>
        <div class="form-check" *ngFor="let n of sections">
          <input class="form-check-input" type="checkbox" value="{{n.name}}" [(ngModel)]="n.selected"
            (change)="checkIfAllSelected()">
          <label class="form-check-label">
            {{n.name}}
          </label>
        </div>
        <mat-divider></mat-divider> -->
        <form [formGroup]="pmForm">
            <div class="row">
                <div class="col-1 text-right">
                    Select Region
                </div>
            <div class="col-2">
                <select name="pm" class="form-control  form-control-sm" formControlName="region">
                    <option *ngFor="let reg of apiserv.regions " [value]="reg.code"><small>{{ reg.text }}</small>
                    </option>
                </select>
            </div>
            <div class="col-1 text-right">Select Project Mgr</div>
            <div class="col-1">
                  <select name="pm" class="form-control  form-control-sm" formControlName="pm">
                    <option *ngFor="let perc of pmlist" [value]="perc"><small>{{ perc }}</small></option>
                </select>
            </div>

       <div class="col-1 text-right">Search</div>
        <div class="col-3">
            <input class="form-control" type="text" [(ngModel)]="searchbox" [ngModelOptions]="{standalone: true}">
        </div>
         <div class="col-1">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" (change)="selectUnlinked()"
                        [checked]="filtercip">
                <label class="form-check-label">
                        No Ciplines
                </label>
        </div>
        </div> 
        <div class="col-2 d-flex justify-content-around">
            <button type="button" class="btn btn-sm btn-success" (click)="exportexcel()">Export to Excel</button>
            <button type="button" 
            [ngClass]="sections ? 'btn btn-sm btn-danger': 'btn btn-sm btn-primary'"
            (click)="toggleView()">{{btntitle}}</button>
    </div>
    </div>
</form>

    <div class="row">
        <div class="col-12">
            <ng-container>
                <table class="table table-striped " id="progress">
                    <thead>
                        <tr>
                            <th class="text-center" style="background-color:azure;"><small>Project_WBS</small></th>
                            <th class="text-left" style="width:275px;background-color:azure;"><small>Known As</small>
                            </th>
                            <th class="text-left" style="width:275px;background-color:azure;"><small>Title</small></th>
                            <th class="text-center" style="width:50px;background-color:azure;">
                                <small>SAP Status</small>
                            </th>
                            <th class="text-center"><small>Forecast <br> Start</small></th>
                            <th class="text-center"><small>Forecast <br>End</small></th>
                            <ng-container *ngIf="!sections">
                            <th class="text-center"><small>Progress</small></th>
                            
                            <!-- <th class="text-left"><small>Register</small></th> -->
                            <th class="text-center"><small>Initiate</small></th>
                            <th class="text-center"><small>Costing</small></th>
                            <th class="text-center"><small>Approval</small></th>
                            <th class="text-center"><small>Board</small></th>
                            <th class="text-center"><small>Leadin</small></th>
                            <th class="text-center"><small>On Site</small></th>
                            <th class="text-center"><small>PoC</small></th>
                            <th class="text-center"><small>Billing</small></th>
                            <th class="text-center"><small>CashFlow</small></th>
                            </ng-container>
                            <ng-container *ngIf="sections">
                            <th class="text-center"><small>POC</small></th>
                            <th class="text-center"><small>Billing</small></th>
                            <th class="text-center"><small>CashFlow</small></th>
                            <th class="text-center"><small>Progress</small></th>
                            <th class="text-center"><small>Budget</small></th>
                            <th class="text-center"><small>Costs</small></th>
                            <th class="text-center"><small>Travel</small></th>
                            <th class="text-center"><small>Commitments</small></th>
                            <th class="text-center"><small>Revenue</small></th>
                            <th class="text-center"><small>M-Fee</small></th>
                            </ng-container>
                        </tr>
                    </thead>
                    <tbody>

                        <tr *ngFor="let item of searchlistnew | searchpipe: [searchbox, 'tag']; let i = index;">

                            <ng-container>
                                <td [ngClass]="item.multisite  ? 'multisite' : 'readonly'" (click)="goTo(item)">
                                    <small>{{item.PROJLINK > 'A' ? item.PROJLINK:item.ABSAREQNO}}</small>
                                </td>
                                <td><small>{{item.KNOWNAS}}</small></td>
                                <td><small>{{item.TITLE}}</small></td>
                                <td><small>{{item.STATUS}}</small></td>
                                <td><input type="date" class="smallinput" name="forecaststart{{i}}"
                                        (change)="newValue($event,i, item)" 
                                        [disabled]="true"
                                        [(ngModel)]="item.DATE06"></td>

                                <td  [ngClass]="item.PHASE > 'PHASE07' ? 'text-center todo' :
                                     item.DATE07 < todaydate ?'text-center late': 'text-center todo'">
                                        {{item.DATE07}}
                                </td>
                                <ng-container *ngIf="!sections">
                                <td  class="text-center" style="background-color:rgb(155, 219, 251);"><small>{{progressCalc(item)+ '%'}}</small></td>
                             
                                    <td [ngClass]="item.PROG02==100 ? 'text-center done' : item.PROG02==0  ?'text-center todo': 'text-center busy'">{{item.PROG02}}</td>
                                    <td [ngClass]="item.PROG03==100 ? 'text-center done' : item.PROG03==0  ?'text-center todo': 'text-center busy'">{{item.PROG03}}</td>
                                    <td [ngClass]="item.PROG04==100 ? 'text-center done' : item.PROG04==0  ?'text-center todo': 'text-center busy'">{{item.PROG04}}</td>
                                    <td [ngClass]="item.PROG05==100 ? 'text-center done' : item.PROG05==0  ?'text-center todo': 'text-center busy'">{{item.PROG05}}</td>
                                    <td [ngClass]="item.PROG06==100 ? 'text-center done' : item.PROG06==0  ?'text-center todo': 'text-center busy'">{{item.PROG06}}</td>
                                    <td [ngClass]="item.PROG07==100 ? 'text-center done' : item.PROG07==0  ?'text-center todo': 'text-center busy'">{{item.PROG07}}</td>
                                    <td [ngClass]="item.PROG08==100 ? 'text-center done' : item.PROG08==0  ?'text-center todo': 'text-center busy'">{{item.PROG08}}</td>
                                    <td [ngClass]="item.PROG09==100 ? 'text-center done' : item.PROG09==0  ?'text-center todo': 'text-center busy'">{{item.PROG09}}</td>
                                    <td [ngClass]="item.PROG10==100 ? 'text-center done' : item.PROG10==0  ?'text-center todo': 'text-center busy'">{{item.PROG10}}</td>
                                    </ng-container>
                                    <ng-container *ngIf="sections">
                                    <td 
                                    [ngClass]="item.PHASE > 'PHASE08' ? 'text-center todo' : item.DATE08 < todaydate  ?'text-center late': 'text-center todo'"
                                    >{{item.DATE08}}</td>
                                    <td    [ngClass]="item.PHASE > 'PHASE09' ? 'text-center todo' : item.DATE09 < todaydate  ?'text-center late': 'text-center todo'"
                                        >{{item.DATE09}}</td>
                                    <td    [ngClass]="item.PHASE > 'PHASEAA' ? 'text-center todo' : item.DATE10 < todaydate  ?'text-center late': 'text-center todo'">{{item.DATE10}}</td>
                                    <td  class="text-center" style="background-color:rgb(155, 219, 251);"><small>{{progressCalc(item)+ '%'}}</small></td>
                                    <td class="text-right odd">{{item.BUDGET}}</td>
                                    <td class="text-right even">{{item.COSTS}}</td>
                                    <td class="text-right odd">{{item.TRAVEL}}</td>
                                    <td class="text-right even">{{item.COMMITMENT}}</td>
                                    <td class="text-right odd">{{item.REVENUE}}</td>
                                    <td class="text-right even">{{item.M_FEE}}</td>
                                    </ng-container>

                                <!-- <ng-container *ngIf="item.PHASE > 'PHASE02'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG03" [disabled]="item.PHASE!=='PHASE03'">
                                            <option *ngFor="let perc of apiserv.scopes" [value]="perc.code">{{ perc.text
                                                }}</option>
                                        </select></td>
                                </ng-container>


                                <ng-container *ngIf="item.PHASE > 'PHASE03'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG04" [disabled]="item.PHASE!=='PHASE04'">
                                            <option *ngFor="let perc of apiserv.approvals" [value]="perc.code">{{
                                                perc.text }}
                                            </option>
                                        </select></td>
                                </ng-container>




                                <ng-container *ngIf="item.PHASE > 'PHASE04'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG05" [disabled]="item.PHASE!=='PHASE05'">
                                            <option *ngFor="let perc of apiserv.scopes" [value]="perc.code">{{ perc.text
                                                }}</option>
                                        </select></td>
                                </ng-container>

                                <ng-container *ngIf="item.PHASE > 'PHASE05'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG06" [disabled]="item.PHASE!=='PHASE06'">
                                            <option *ngFor="let perc of apiserv.scopes" [value]="perc.code">{{ perc.text
                                                }}</option>
                                        </select></td>
                                </ng-container>

                                <ng-container *ngIf="item.PHASE > 'PHASE06'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG07" [disabled]="item.PHASE!=='PHASE07'">
                                            <option *ngFor="let perc of apiserv.scopes" [value]="perc.code">{{ perc.text
                                                }}</option>
                                        </select></td>
                                </ng-container>


                                <ng-container *ngIf="item.PHASE > 'PHASE07'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG08" [disabled]="item.PHASE!=='PHASE08'">
                                            <option *ngFor="let perc of apiserv.scopes" [value]="perc.code">{{ perc.text
                                                }}</option>
                                        </select></td>
                                </ng-container>

                                <ng-container *ngIf="item.PHASE > 'PHASE08'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG09" [disabled]="item.PHASE!=='PHASE09'">
                                            <option *ngFor="let perc of apiserv.scopes" [value]="perc.code">{{ perc.text
                                                }}</option>
                                        </select></td>
                                </ng-container>


                                <ng-container *ngIf="item.PHASE > 'PHASE09'">
                                    <td style="background-color:rgb(238, 248, 248);"><select class="smallinput"
                                            name="scope{{i}}" (change)="newValue($event,i, item)"
                                            [(ngModel)]="item.PROG10" [disabled]="item.PHASE!=='PHASE10'">
                                            <option *ngFor="let perc of apiserv.scopes" [value]="perc.code">{{ perc.text
                                                }}</option>
                                        </select></td>
                                </ng-container> -->
                            </ng-container>
                        </tr>
                    </tbody>
                </table>
            </ng-container>
        </div>
    </div>
</div>