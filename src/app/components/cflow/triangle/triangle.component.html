
<div class="mycontainer">
    <div class="row">
     
            <div class="col-12">

<div class="row">
                
                                  
                                    <div class="col-1 text-right pr-2">
                                            <small>Free search</small>
                                    </div>
                                    <div class="col-5">
                                            <input class="form-control  form-control-sm " type="text" id="searchbox"
                                                    [(ngModel)]="searchbox" [ngModelOptions]="{standalone: true}">
                                    </div>

                                    <div class="col-1">
                                            <button type="button" class="btn btn-sm btn-success"
                                                    (click)="exportexcel()">
                                                    Export to Excel
                                            </button>
                                    </div>
                                </div>
           
   

                    <table class="table table-bordered" id="apptopolist">
                            <tr>
                                    <th class="text-center"><small style="font-weight: bold;">Project</small></th>
                                    <th class="text-center"><small style="font-weight: bold;">Region</small></th>
                                    <th class="text-center"><small style="font-weight: bold;">Oneview</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">Knownas</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">Title</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">Submit</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">Approval<br>Board</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">Approval<br>Absa Legal</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">Approval<br>BFM Legal</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">Approval <br> Amt incl</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">PO Date</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">PO Number</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">PO<br> Amt incl</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">SAP PO<br> </small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">SAP PO<br> Amt incl</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">SAP <br>Prev Yr Incl</small></th>
                                    <th style="background-color:rgb(114, 171, 251);" class="text-center"><small
                                                    style="font-weight: bold;">CipBudget<br>Initiative</small></th>
                                   
                            </tr>
                            <tr *ngFor="let budgetview of searchlistnew  | searchpipe: [searchbox, 'tag']">
                                    <td ><small>{{budgetview.PROJLINK}}</small></td>
                                    <td ><small>{{budgetview.REGION}}</small></td>
                                    <td ><small>{{budgetview.ONEVIEW}}</small></td>
                                    <td ><small>{{budgetview.KNOWNAS.substring(0,40)}}</small></td>
                                    <td ><small>{{budgetview.TITLE}}</small></td>
                                    <td ><small>{{budgetview.APPROVAL_SUBMITDATE}}</small></td>
                                    <td ><small>{{budgetview.APPROVAL_DATE}}</small></td>
                                    <td ><small>{{budgetview.APPROVEDBYLEGAL}}</small></td>
                                    <td ><small>{{budgetview.APPBYBFMLEGAL}}</small></td>
                                    <td [ngClass]="budgetview.APPROVED_AMT.toFixed(2) != ( budgetview.POVALUE * 115 / 100 ).toFixed(2) ? 'text-center warn':
                                    'text-center todo'"><small>{{(budgetview.APPROVED_AMT).toFixed(2)}}</small></td>
                                    <td ><small>{{budgetview.PODATE}}</small></td>
                                    <td ><small>{{budgetview.PONUMBER}}</small></td>
                                    <td ><small>{{(budgetview.POVALUE * 115 / 100 ).toFixed(2) }}</small></td>
                                    <td [ngClass]="budgetview.PONUMBER != budgetview.SAP_PO? 'text-center late':
                                      'text-center todo'"
                                    ><small>{{budgetview.SAP_PO}}</small></td>
                                    <td [ngClass]="budgetview.POVALUE != budgetview.SAP_POVALUE? 'text-center late':
                                    'text-center todo'"
                                  ><small>{{(budgetview.SAP_POVALUE * 115 / 100).toFixed(2)}}</small></td>
                                    <td class="text-center"><small>{{(budgetview.PYVALUE * 115 / 100).toFixed(2)}}</small></td>
                                    <td class="text-center"><small>{{budgetview.INITIATIVE}}</small></td>                              
                                  
                                    
                            </tr>
                    </table>
            </div>
            </div>
    </div>

